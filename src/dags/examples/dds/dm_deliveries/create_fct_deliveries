drop table dds.fct_deliveries cascade;
CREATE TABLE dds.fct_deliveries (
	id serial4 NOT null PRIMARY KEY,
	courier_id int4  NOT NULL,
	delivery_id int4 not null,
 	order_id int4 NOT NULL,
	count int4 NOT NULL DEFAULT 0,
	price numeric(14, 2) NOT NULL DEFAULT 0 CHECK (price >= 0),
	total_sum numeric(14, 2) NOT NULL DEFAULT 0 CHECK (total_sum >= 0),
	tip_sum numeric(14, 2) NOT NULL DEFAULT 0 CHECK (tip_sum >= 0),
	reward_sum numeric(14, 2) NOT NULL DEFAULT 0 CHECK (reward_sum >= 0)
 
);


-- dds.fct_product_sales foreign keys

ALTER TABLE dds.fct_deliveries  ADD CONSTRAINT fct_deliveries_courier_id_fkey FOREIGN KEY (courier_id) REFERENCES dds.dm_couriers(id);
ALTER TABLE dds.fct_deliveries  ADD CONSTRAINT fct_deliveries_delivery_id_fkey FOREIGN KEY (delivery_id) REFERENCES dds.dm_deliveries(id);
